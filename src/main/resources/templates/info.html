<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>on Me</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
    <link href="http://cdn.jsdelivr.net/webjars/bootstrap/3.3.4/css/bootstrap.min.css"
          th:href="@{/webjars/bootstrap/3.3.4/css/bootstrap.min.css}"
          rel="stylesheet" media="screen" />
 
    <script src="http://cdn.jsdelivr.net/webjars/jquery/2.1.4/jquery.min.js"
            th:src="@{/webjars/jquery/2.1.4/jquery.min.js}">
    </script>
            
    <script type="text/javascript" 
    		src="../static/js/jquery.qrcode.js"
    		th:src="@{js/jquery.qrcode.js}"></script>
    		
	<script type="text/javascript" 
			src="../static/js/qrcode.js"
			th:src="@{js/qrcode.js}"></script>
			
<!-- 	<link rel="stylesheet" type="text/css" href="../static/css/infostyle.css" th:href="@{/static/css/infostyle.css}"/> -->
	<style>
	
	#qrcodeTable {
		text-align: center;
	}
	</style>

</head>

<body>

<div class="container">
    <div class="jumbotron">
        <img src="../static/images/ebay.png"
             th:src="@{images/ebay.png}"
             style="width:100%;height:100%;"/>
             
        <h1>QR Code</h1>
    	<p th:text= "'TID that will be turned into QR Code: ' + ${info.tid}" />
    	
    	<h1>Google Maps Integration</h1>
    	<p th:text="'Gift Pickup Lat: ' + ${info.lat}" />
    	<p th:text="'Gift Pickup Lon: ' + ${info.lon}" />  
    	
    </div>
	
	<script th:inline="javascript">
		
		/*<![CDATA[*/
		                        
  		$(document).ready(function() {
  			initMap();
  		});
  		
  		function initMap() {
  			alert("Init Map");
  			var tid = /*[[${info.tid}]]*/;  
  			
  			jQuery('#qrcodeTable').qrcode({
  	      		render    : "table",
  	      		text    : 'TID: ' + tid
  	  		});

  			navigator.geolocation.getCurrentPosition(success);
  		}
  		
  		function success(position) {
  		    var pos = {
  		       lat: position.coords.latitude,
  		       lng: position.coords.longitude
  		     };
  		 var chicago = {lat: 41.85, lng: -87.65};
  		 var indianapolis = {lat: 39.79, lng: -86.14};
  		 chicago = pos;

  		 var map = new google.maps.Map(document.getElementById('map'), {
  		   center: chicago,
  		   scrollwheel: false,
  		   zoom: 7
  		 });

  		 var directionsDisplay = new google.maps.DirectionsRenderer({
  		   map: map
  		 });

  		 // Set destination, origin and travel mode.
  		 var request = {
  		   destination: indianapolis,
  		   origin: chicago,
  		   travelMode: google.maps.TravelMode.DRIVING
  		 };

  		 // Pass the directions request to the directions service.
  		 var directionsService = new google.maps.DirectionsService();
  		 directionsService.route(request, function(response, status) {
  		   if (status == google.maps.DirectionsStatus.OK) {
  		     // Display the route on the map.
  		     directionsDisplay.setDirections(response);
  		   }
  		 });
  		}
  		
  		/*]]>*/
	</script>
	
	
	<!-- <script
		src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCcYblLLguNebQpe1Mw8MgvL8LlwmKFRto&callback=initMap" async defer>
	</script> -->
	
	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRhdHLuZOo4vQE1eN0WVAt7fLI-VV3Pxg">
	</script>
	
</div>


	<div id="qrcodeTable"></div>
	
	<div id="map"></div>

	<div class="container">
 		<button type="button" class="btn btn-lg btn-primary">Gift Back?</button>
	</div>
   
</body>

</html>

